

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>selinux &mdash; Red Hat Enterprise RHCSA | RHCSE Preparation 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Red Hat Enterprise RHCSA | RHCSE Preparation 0.0.1 documentation" href="../index.html"/>
        <link rel="up" title="Security" href="index.html"/>
        <link rel="next" title="Help" href="../help/Help.html"/>
        <link rel="prev" title="encryption" href="encryption.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Red Hat Enterprise RHCSA | RHCSE Preparation
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/Installation.html">CentOs Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/Installation.html#force-text-setup">Force Text Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/Installation.html#how-to-setup-a-local-yum-repository-for-locally-mounted-dvd-iso">How to setup a local yum repository for locally mounted DVD/ISO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/Installation.html#how-to-install-display-manager-gnome-after-initial-minimal-installation">How to install Display Manager (GNOME) after initial (minimal) Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/Installation.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/kickstart.html">kickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/kickstart.html#how-to-start-installation-with-kickstart-file">How to start installation with kickstart file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kickstart.html#important-kickstart-file-options">Important kickstart file options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kickstart.html#working-example-for-kvm-based-kickstart-installation">Working example for KVM based kickstart installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/kickstart.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/kvm.html">kvm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#does-my-cpu-support-virtualization-and-is-it-enabled-in-bios-uefi">Does my CPU support Virtualization and is it enabled in BIOS / UEFI?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#how-to-run-nested-kvm-within-vmware-esxi-5-5">How to run nested KVM within VMWare ESXi (5.5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#packages-to-install-for-kvm-in-rhel">Packages to install for KVM in RHEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#move-kvm-storage-location-to-another-place">Move KVM Storage location to another place</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#file-permission-issues-when-changing-the-vm-storage-location-to-another-place">File permission issues when changing the VM Storage location to another place</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/kvm.html#application-documentation-admin-usertasks-a-s-o">Application documentation - admin, usertasks a.s.o</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/kvm.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Networking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../networking/network-configuration-troubleshooting.html">network-configuration-troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-configuration-troubleshooting.html#configuring-vlan-trunk-with-sub-interfaces">Configuring VLAN Trunk With Sub-Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../networking/network-configuration-troubleshooting.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../networking/network-commands.html">network-commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-commands.html#ifconfig-arp-netstat-route-are-obsolete">ifconfig | arp | netstat | route are “obsolete”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-commands.html#configure-manipulate-network-adapter">Configure | Manipulate Network Adapter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-commands.html#network-manager">Network Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-commands.html#graphical-networking-user-interfaces">Graphical Networking User Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/network-commands.html#network-connection-directives">Network Connection Directives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../networking/network-commands.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../networking/routing.html">routing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../networking/routing.html#how-to-enable-routing-permanently">How to enable routing permanently</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/routing.html#default-route-configuration">Default Route Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/routing.html#static-routes">Static Routes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../networking/routing.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../networking/dns.html">dns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../networking/dns.html#etc-nsswitch-conf">/etc/nsswitch.conf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networking/dns.html#hostname">Hostname</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../networking/dns.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../applications/index.html">Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../applications/shell.html">1. shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/shell.html#text-streams-and-redirection">1.1. Text Streams and redirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/shell.html#ln-hardlink-vs-softlink">1.2. ln - Hardlink vs. Softlink</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/shell.html#sed-stream-editor">1.3. sed - Stream Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/shell.html#awk-aho-weinberger-and-kernighan">1.4. awk - Aho, Weinberger, and Kernighan</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/shell.html#indices-and-tables">1.4.1. Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/ssh.html">ssh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/ssh.html#ssh-tunnel">ssh tunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/ssh.html#basic-encrypted-communication">Basic Encrypted Communication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/ssh.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/apache.html">apache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/apache.html#copy-rhel-cdrom-content-to-webserver-directory">Copy RHEL CDROM content to webserver directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/apache.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/vsftpd.html">vsftpd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/vsftpd.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/vncserver.html">4. vncserver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/vncserver.html#indices-and-tables">4.1. Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/kvm.html">kvm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#mounting-installation-media-for-vm-installation">Mounting installation media for VM installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#important-files-and-directories">Important Files and directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#important-commands">Important commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#virt-install">virt-install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#virt-install-with-kickstart-file">virt-install with kickstart file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#delete-a-vm-from-command-line">Delete a VM from command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#virsh">virsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/kvm.html#virt-clone">virt-clone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/kvm.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/index.html#list-of-applications-that-should-be-present-on-a-system">List of applications, that should be present on a system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications/index.html#man-and-how-to-find-documentation">man and how to find documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commands-collection/index.html">Commands Collection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/dd.html">dd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/dd.html#dd-copy">dd copy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../commands-collection/dd.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/yum.html">yum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#find-rpm-package-containing-a-certain-command">Find RPM package containing a certain command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#which-packages-are-installed-within-the-base-package-group">Which packages are installed within the <strong>base</strong> package group?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#how-to-create-a-local-repository-copy-from-cdrom-iso-e-g-on-web-server">How to create a local repository copy from CDROM / ISO e.g. on web server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#epel-extra-packages-for-enterprise-linux">EPEL - Extra Packages for Enterprise Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#how-to-setup-a-local-yum-repository-for-locally-mounted-iso">How to setup a local yum repository for locally mounted ISO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/yum.html#how-to-setup-a-local-yum-repository-for-locally-mounted-cdrom-dvd">How to setup a local yum repository for locally mounted CDROM/DVD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../commands-collection/yum.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/rpm.html">rpm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/rpm.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/mount.html">mount</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/mount.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/ssh.html">ssh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands-collection/ssh.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands-collection/index.html#find-out-linux-distribution-and-version">Find Out Linux Distribution And Version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kernel/index.html">Kernel Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html#verify-and-load-kernel-modules">Verify And Load Kernel Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html#load-kernel-module-persistent">Load Kernel Module Persistent</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="permissions.html">permissions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#chmod">chmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#special-permission-bits">Special Permission Bits</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#file-attributes">File Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#umask">UMASK</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#access-control-lists">Access Control Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#manage-acls-on-a-file">Manage ACLs on a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#default-acls">Default ACLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="permissions.html#acl-and-masks">ACL and Masks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="firewall.html">firewall</a><ul>
<li class="toctree-l3"><a class="reference internal" href="firewall.html#the-firewalld-service">The firewalld Service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">encryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="encryption.html#basic-encrypted-communication">Basic Encrypted Communication</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">selinux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-features-of-selinux">Basic Features of SELinux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selinux-status">SELinux Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-selinux-configuration-and-settings">Basic SELINUX Configuration and Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-context-types-essentials-for-rhcsa">Setting Context Types (Essentials for RHCSA !)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finding-the-context-type-you-need">Finding the Context Type You Need</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-regular-users-for-selinux-not-needed-for-rhcsa">Configure Regular Users for SELinux (not needed for RHCSA !)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manage-selinux-boolean-settings">Manage SELinux Boolean Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list-and-identify-selinux-file-contexts">List and Identify SELinux File Contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restore-selinux-file-contexts">Restore SELinux File Contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identify-selinux-process-contexts">Identify SELinux Process Contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diagnose-and-address-selinux-policy-violations">Diagnose and Address SELinux Policy Violations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-gui-selinux-administration-tool">The GUI SELinux Administration Tool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../help/Help.html">Help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../help/Help.html#further-help">Further Help</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Red Hat Enterprise RHCSA | RHCSE Preparation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Security</a> &raquo;</li>
        
      <li>selinux</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/security/selinux.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="selinux">
<h1>selinux<a class="headerlink" href="#selinux" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-features-of-selinux">
<h2>Basic Features of SELinux<a class="headerlink" href="#basic-features-of-selinux" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>The SELinux security model is based on subjects, objects, and actions.</dt>
<dd><ul class="first last simple">
<li>A subject is a process, such as a running command or an application such as the Apache web server in operation.</li>
<li>An object is a file, a device, a socket, or in general any resource that can be accessed by a subject.</li>
<li>An action is what may be done by the subject to the object.</li>
</ul>
</dd>
</dl>
<p>SELinux assigns different <strong>contexts</strong> to objects. A context is just a label, which is used by
the SELinux security policy to determine whether a subject’s action on an object is allowed
or not.</p>
<p>To see the context of a particular file, run the <strong>ls -Z</strong> command.</p>
</div>
<div class="section" id="selinux-status">
<h2>SELinux Status<a class="headerlink" href="#selinux-status" title="Permalink to this headline">¶</a></h2>
<p>As suggested in the RHCSA objectives, you need to know how to “set enforcing and
permissive modes for SELinux.” There are three available modes for SELinux: <strong>enforcing, permissive, and disabled</strong>.
The enforcing and disabled modes are self-explanatory.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">Z</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">unconfined_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">acltest</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Desktop</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Documents</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Downloads</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">audio_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Music</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Pictures</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Public</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Templates</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">gans</span> <span class="n">gans</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">user_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">Videos</span>
</pre></div>
</div>
<p>Equivalent commands for processes, network connections</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">-</span><span class="n">Zaux</span>
<span class="n">ss</span> <span class="o">-</span><span class="n">Z</span>
<span class="n">netstat</span> <span class="o">-</span><span class="n">Z</span>
</pre></div>
</div>
<p>SELinux in <strong>permissive</strong> mode means that any SELinux rules that are violated are logged, but the violation does not stop any action.
If you want to change the default SELinux mode, change the SELINUX directive in the <strong>/etc/selinux/config</strong> file.
The next time you reboot, the changes are applied to the system.</p>
<p>If SELinux is configured in enforcing mode, it protects systems in one of two ways: in
targeted mode or in mls mode. The default is the targeted policy, which allows you to
customize what is protected by SELinux in a fine-grained manner. In contrast, MLS goes a
step further, using the Bell-La Padula model developed for the US Department of Defense.</p>
<p>If you just want to experiment with SELinux, configure it in permissive mode. It’ll
log any violations without stopping anything. It’s easy to set up with the SELinux
Administration tool, or you can set SELINUX=permissive in /etc/selinux/config. If
the auditd service is running, violations are logged in the audit.log file in the
/var/log/audit directory. Just remember, it’s likely that Red Hat wants candidates
to configure SELinux in enforcing mode during the exams.</p>
</div>
<div class="section" id="basic-selinux-configuration-and-settings">
<h2>Basic SELINUX Configuration and Settings<a class="headerlink" href="#basic-selinux-configuration-and-settings" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">getenforce</span>
<span class="n">Enforcing</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sestatus</span>
<span class="n">SELinux</span> <span class="n">status</span><span class="p">:</span>                 <span class="n">enabled</span>
<span class="n">SELinuxfs</span> <span class="n">mount</span><span class="p">:</span>                <span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="o">/</span><span class="n">selinux</span>
<span class="n">SELinux</span> <span class="n">root</span> <span class="n">directory</span><span class="p">:</span>         <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span>
<span class="n">Loaded</span> <span class="n">policy</span> <span class="n">name</span><span class="p">:</span>             <span class="n">targeted</span>
<span class="n">Current</span> <span class="n">mode</span><span class="p">:</span>                   <span class="n">enforcing</span>
<span class="n">Mode</span> <span class="kn">from</span> <span class="nn">config</span> <span class="n">file</span><span class="p">:</span>          <span class="n">enforcing</span>
<span class="n">Policy</span> <span class="n">MLS</span> <span class="n">status</span><span class="p">:</span>              <span class="n">enabled</span>
<span class="n">Policy</span> <span class="n">deny_unknown</span> <span class="n">status</span><span class="p">:</span>     <span class="n">allowed</span>
<span class="n">Max</span> <span class="n">kernel</span> <span class="n">policy</span> <span class="n">version</span><span class="p">:</span>      <span class="mi">28</span>
</pre></div>
</div>
<p>You can change the current SELinux status with the setenforce command; the options
are straightforward:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">setenforce</span> <span class="n">enforcing</span>
<span class="n">setenforce</span> <span class="n">permissive</span>
</pre></div>
</div>
<p>To make this change permanent, you’ll have to modify the SELINUX variable in the <strong>/etc/selinux/config</strong> file.</p>
</div>
<div class="section" id="setting-context-types-essentials-for-rhcsa">
<h2>Setting Context Types (Essentials for RHCSA !)<a class="headerlink" href="#setting-context-types-essentials-for-rhcsa" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>There are two commands to set context type:</dt>
<dd><ul class="first last simple">
<li>semanage - This is the command you want to use</li>
<li>chcon - Use it only in specific cases - <strong>should normally be avoided</strong> - does not survive file system is relabeled !</li>
</ul>
</dd>
</dl>
<p>To set context using semanage, you need to find out the correct context.
The easy way is to look for default context settings for alreasy existing items (e.g. files / directories)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">Z</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">httpd_sys_script_exec_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">cgi</span><span class="o">-</span><span class="nb">bin</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">httpd_sys_content_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">html</span>
</pre></div>
</div>
<p>To set this type for html directory to any new directory that should be accessible by the Apache web server,
use the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">fcontext</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">t</span> <span class="n">httpd_sys_content_t</span> <span class="s2">&quot;/mydir(/.*)?&quot;</span>
</pre></div>
</div>
<p>The option <strong>-a</strong> is used to add a context type.
The option <strong>-t</strong> is used to change a context type (as opposed to user and role)</p>
<p>Setting the context this way is not enough, because it writes it only to the policy and not to the file system.
To complete the task, you need to apply the policy to the file system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">restorecon</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">mydir</span>
</pre></div>
</div>
<p>It is not easy to remember the <strong>semanage fcontext</strong> command.
<strong>There is a good man page for it - man semanage-fcontext - with useful examples at the bottom !</strong></p>
</div>
<div class="section" id="finding-the-context-type-you-need">
<h2>Finding the Context Type You Need<a class="headerlink" href="#finding-the-context-type-you-need" title="Permalink to this headline">¶</a></h2>
<p>This is one of the challenging parts of setting SELINUX contexts.
Roughly, there are three approaches:</p>
<blockquote>
<div><ul class="simple">
<li>Look at the default environment</li>
<li>Read the configuration files</li>
<li>Use <strong>man -k _selinux</strong> to find SELinux-specific man pages for your service</li>
</ul>
</div></blockquote>
<p>The <strong>man -k _selinux</strong> pages are not installed by default.
To install them you need the package <strong>policycoreutils-devel</strong> and then another task:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sepolicy</span> <span class="n">manpage</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man8</span>
</pre></div>
</div>
<p>This is an essential skill - you should master it before going to the exam:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>man -k _selinux</strong> - it will only provide one or two man pages</li>
<li><strong>yum whatprovides */sepolicy</strong></li>
<li><strong>yum install policycoreutils-devel</strong></li>
<li><strong>sepolicy manpage -a -p /usr/share/man/man8</strong></li>
<li><strong>man -k _selinux</strong> - you’ll see no changes</li>
<li><strong>mandb</strong></li>
<li>This takes some time, after that a lot more man pages should appear with the man command</li>
<li><strong>man -k _selinux | grep http</strong> as example for finding the correct context</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="configure-regular-users-for-selinux-not-needed-for-rhcsa">
<h2>Configure Regular Users for SELinux (not needed for RHCSA !)<a class="headerlink" href="#configure-regular-users-for-selinux-not-needed-for-rhcsa" title="Permalink to this headline">¶</a></h2>
<p>To review the status of current SELinux users, run the semanage login -l command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">login</span> <span class="o">-</span><span class="n">l</span>

<span class="n">Login</span> <span class="n">Name</span>           <span class="n">SELinux</span> <span class="n">User</span>         <span class="n">MLS</span><span class="o">/</span><span class="n">MCS</span> <span class="n">Range</span>        <span class="n">Service</span>

<span class="n">__default__</span>          <span class="n">unconfined_u</span>         <span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>       <span class="o">*</span>
<span class="n">root</span>                 <span class="n">unconfined_u</span>         <span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>       <span class="o">*</span>
<span class="n">system_u</span>             <span class="n">system_u</span>             <span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>       <span class="o">*</span>
</pre></div>
</div>
<p>In other words, regular “default” users have the same SELinux user context of the
root administrative user. To confirm, run the id -Z command as a regular user. Without
changes, it leads to the following output, which suggests that the user is not confined by any
SELinux settings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>
</pre></div>
</div>
<p>In other words, regular “default” users have the same SELinux user context of the
root administrative user. To confirm, run the id -Z command as a regular user.</p>
<p>The preceding string defines what is called a label in SELinux jargon. A label is made up
of several context strings, separated by a column: a user context (which ends with a _u), a
role context (which ends with _r), a type context (which ends with _t), a sensitivity context,
and a category set. The rules of the targeted policy, which is the default SELinux policy in
RHEL 7, are mostly associated with the type (_t) context.</p>
<p>Although it may not be an exam requirement, regular users should be confined by
SELinux. When user accounts are compromised, and they will be compromised, you want
any damage that might be caused limited by SELinux rules. The following example specifies
a confinement rule that adds (-a) regular user michael, specifying (-s) the user_u context for
confinement:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">login</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">s</span> <span class="n">user_u</span> <span class="n">michael</span>
</pre></div>
</div>
<p>f desired, you can reverse the process with the <strong>semanage -d michael</strong> command.</p>
<p>When a user role is changed, it doesn’t take effect until the next login. For example, if
we were to change the role for user michael to user_u in a GUI-based command line, the
change would not take effect until we logged out and logged back in to the GUI. If you
were to try this on your system, you would no longer be able to start any administrative
configuration tools, and you would not have access to the sudo and su commands.
On some networks, you may want to change the role of future users to user_u. If you
don’t want regular users tinkering with administrative tools, you could make that change for
future default users with the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">login</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">S</span> <span class="n">targeted</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;user_u&quot;</span> <span class="o">-</span><span class="n">r</span> <span class="n">s0</span> <span class="n">__default__</span>
</pre></div>
</div>
<p>This command modifies (-m) the targeted policy store (-S), with SELinux user (-s)
user_u, with the MLS s0 range (-r) for the default user. Here, “__default__” includes two
underscore characters on each side of the word. As long as user_u is in effect for the default
SELinux user, regular users won’t have access to use administrative tools or commands such
as su and sudo. The following command reverses the process:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">login</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">S</span> <span class="n">targeted</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;unconfined_u&quot;</span> \
<span class="o">-</span><span class="n">r</span> <span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span> <span class="n">__default__</span>
</pre></div>
</div>
<img alt="../_images/rhel_selinux_user_roles.png" src="../_images/rhel_selinux_user_roles.png" />
</div>
<div class="section" id="manage-selinux-boolean-settings">
<h2>Manage SELinux Boolean Settings<a class="headerlink" href="#manage-selinux-boolean-settings" title="Permalink to this headline">¶</a></h2>
<p>Most SELinux settings are boolean- in other words, they’re activated and deactivated by
setting them to 1 or 0, respectively. Once set, the booleans can be retrieved from the
/sys/fs/selinux/booleans directory. One simple example is selinuxuser_ping, which is
normally set to 1, which allows users to run the ping and traceroute commands.</p>
<p>These settings can be read with the <strong>getsebool -a</strong> and modified with the <strong>setsebool</strong> commands.
For example, the following output from the getsebool user_exec_content command confirms
that SELinux allows users to execute scripts either in their home directories or from the /tmp
directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">user_exec_content</span> <span class="o">--&gt;</span> <span class="n">on</span>
</pre></div>
</div>
<p>For example, the following command disables the noted boolean until the system is rebooted:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">setsebool</span> <span class="n">user_exec_content</span> <span class="n">off</span>
</pre></div>
</div>
<p>A full list of available booleans is available in the output to the <strong>getsebool -a</strong> command.
For more information on each boolean, run the <strong>semanage boolean -l</strong> command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">getsebool</span> <span class="o">-</span><span class="n">a</span>
<span class="n">semanage</span> <span class="n">boolean</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
</div>
<div class="section" id="list-and-identify-selinux-file-contexts">
<h2>List and Identify SELinux File Contexts<a class="headerlink" href="#list-and-identify-selinux-file-contexts" title="Permalink to this headline">¶</a></h2>
<p>If you’ve enabled SELinux, the ls -Z command lists current SELinux file contexts, as shown
earlier in Figure 4-10. As an example, take the relevant output for the anaconda-ks.cfg file
from the /root directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rw</span><span class="o">-------.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">admin_home_t</span><span class="p">:</span><span class="n">s0</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">ks</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
<p>It specifies four elements of SELinux security: <strong>the user, role, type, and MLS level</strong> for the noted file.
Generally, the SELinux user associated with a file is system_u or unconfined_u, and this
generally does not affect access. In most cases, files are associated with an object_r, an
object role for the file. It’s certainly possible that future versions of the SELinux targeted
policy will include more fine-grained options for the user and role.</p>
<p>The key file context is the type, in this case, <strong>admin_home_t</strong>. When you configured FTP
and HTTP servers in Chapter 1, you changed the type of the configured directory and the
files therein to match the default type of shared files from those services with the chcon
command.</p>
<p>For example, to configure a nonstandard directory for an FTP server, make sure the
context matches the default FTP directory. Consider the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">Z</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ftp</span><span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">public_content_t</span> <span class="n">pub</span>
</pre></div>
</div>
<p>If you create an /ftp directory as the root user and run the ls -Zd /ftp command,
you’ll see the contexts associated with the /ftp directory as shown:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">unconfined_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">root_t</span> <span class="o">/</span><span class="n">ftp</span>
</pre></div>
</div>
<p>To change the context, use the chcon command. If there are subdirectories, you’ll want
to make sure changes are made recursively with the -R switch. In this case, to change the
user and type contexts to match /var/ftp, run the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chcon</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">u</span> <span class="n">system_u</span> <span class="o">-</span><span class="n">t</span> <span class="n">public_content_t</span> <span class="o">/</span><span class="n">ftp</span>
</pre></div>
</div>
<p>If you want to support uploads to your FTP server, you’ll have to assign a different type
context, specifically public_content_rw_t. That corresponds to the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chcon</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">u</span> <span class="n">system_u</span> <span class="o">-</span><span class="n">t</span> <span class="n">public_content_rw_t</span> <span class="o">/</span><span class="n">ftp</span>
</pre></div>
</div>
<p>In Chapter 1, you used a different variation on the chcon command. To use that lesson,
the following command uses user, role, and context from the /var/ftp directory and applies
the changes recursively:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chcon</span> <span class="o">-</span><span class="n">R</span> <span class="o">--</span><span class="n">reference</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ftp</span> <span class="o">/</span><span class="n">ftp</span>
</pre></div>
</div>
<p>Using <strong>restorecon</strong> is the preferred way to change file contexts because it sets the
contexts to the values configured in the SELinux policy. The <strong>chcon</strong> command can
modify file contexts to any value passed as an argument, but the change may not
survive a filesystem relabeling if a context differs from the default value defined
in the SELinux policy.
Hence, to avoid mistakes, you should modify contexts in the SELinux policy with <strong>semanage fcontext</strong>
and use <strong>restorecon</strong> to change file contexts.</p>
</div>
<div class="section" id="restore-selinux-file-contexts">
<h2>Restore SELinux File Contexts<a class="headerlink" href="#restore-selinux-file-contexts" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>How are context settings applied?</dt>
<dd><ul class="first last simple">
<li>If a new file is created, it inherits the context settings from the parent directory</li>
<li>If a file is copied to a directory, this is considered a new file, so it inherits the context settings from the parent directory</li>
<li>If a file is moved, or copied while keeping its properties (by using <strong>cp -a</strong>), the original file context settings of the file are applied</li>
</ul>
</dd>
</dl>
<p>Especially the latter of these three situations is easily fixed by using restorecon.
It is also possible to relabel the entire file system - this could be a good idea.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">restorecon</span> <span class="o">-</span><span class="n">Rv</span> <span class="o">/</span>
</pre></div>
</div>
<p>Default contexts are configured in /etc/selinux/targeted/contexts/files/file_contexts. If you
make a mistake and want to restore the original SELinux settings for a file, the restorecon
command restores those settings based on the file_contexts configuration file. However, the
defaults in a directory may vary. For example, the following command (with the -F switch
forcing a change to all contexts rather than just the type context) leads to a different set of
contexts for the /ftp directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># restorecon -F /ftp</span>
<span class="c1"># ls -Zd /ftp</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">default_t</span> <span class="n">ftp</span>
</pre></div>
</div>
<p>You may also list all default file contexts rules in file_contexts with the <strong>semanage fcontext -l</strong> command.</p>
<p>As an example, a regular expression that matches the /ftp directory and all files in it is
given by the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>/ftp(/.*)?
</pre></div>
</div>
<p>Using this regular expression, we can define a SELinux policy rule that assigns to the
/ftp directory and all files in it a default type context. This can be done with the <strong>semanage fcontext -a</strong> command.
For example, the following command assigns a default type context
of public_content_t to the /ftp directory and all the files in it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">semanage</span> <span class="n">fcontext</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">t</span> <span class="n">public_content_t</span> <span class="s1">&#39;/ftp(/.*)?&#39;</span>
</pre></div>
</div>
<p>Once you have defined a new default policy context for a filesystem path, you can run
the restorecon command to set the contexts to the corresponding default policy values.</p>
<p>The following command restores the context recursively (-R) to the public_content_t value defined previously:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">restorecon</span> <span class="o">-</span><span class="n">RF</span> <span class="o">/</span><span class="n">ftp</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">Zd</span> <span class="o">/</span><span class="n">ftp</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="n">root</span> <span class="n">root</span> <span class="n">system_u</span><span class="p">:</span><span class="n">object_r</span><span class="p">:</span><span class="n">public_content_t</span> <span class="n">ftp</span>
</pre></div>
</div>
</div>
<div class="section" id="identify-selinux-process-contexts">
<h2>Identify SELinux Process Contexts<a class="headerlink" href="#identify-selinux-process-contexts" title="Permalink to this headline">¶</a></h2>
<p>The ps command lists currently running processes.
In a SELinux system, there are contexts for each running process.
To see those contexts for all processes currently in operation, run the <strong>ps -eZ</strong> command, which lists every (-e) process SELinux
context (-Z).</p>
<dl class="docutils">
<dt>::</dt>
<dd>ps -eZ
system_u:system_r:irqbalance_t:s0 701 ?        00:00:13 irqbalance
system_u:system_r:syslogd_t:s0    705 ?        00:00:13 rsyslogd
system_u:system_r:alsa_t:s0       707 ?        00:00:00 alsactl
system_u:system_r:policykit_t:s0  708 ?        00:00:30 polkitd
system_u:system_r:abrt_t:s0-s0:c0.c1023 710 ?  00:00:00 abrtd
system_u:system_r:abrt_watch_log_t:s0 712 ?    00:00:00 abrt-watch-log
system_u:system_r:modemmanager_t:s0 713 ?      00:00:00 ModemManager
system_u:system_r:fsdaemon_t:s0   716 ?        00:00:00 smartd
system_u:system_r:rtkit_daemon_t:s0 720 ?      00:00:02 rtkit-daemon
system_u:system_r:systemd_logind_t:s0 722 ?    00:00:07 systemd-logind
system_u:system_r:lsmd_t:s0       726 ?        00:00:00 lsmd
system_u:system_r:avahi_t:s0      727 ?        00:00:00 avahi-daemon
system_u:system_r:abrt_watch_log_t:s0 728 ?    00:00:00 abrt-watch-log
system_u:system_r:system_dbusd_t:s0-s0:c0.c1023 731 ? 00:00:30 dbus-daemon
system_u:system_r:avahi_t:s0      740 ?        00:00:00 avahi-daemon
system_u:system_r:chronyd_t:s0    742 ?        00:00:01 chronyd</dd>
</dl>
</div>
<div class="section" id="diagnose-and-address-selinux-policy-violations">
<h2>Diagnose and Address SELinux Policy Violations<a class="headerlink" href="#diagnose-and-address-selinux-policy-violations" title="Permalink to this headline">¶</a></h2>
<p>If there’s a problem, SELinux is running in enforcing mode, and you’re sure there are no
problems with the target service or application, don’t disable SELinux! Red Hat has made it
easier to manage and troubleshoot. According to Red Hat, the top two causes of SELinux-
related problems are contexts and boolean settings.</p>
<p>Problems with SELinux should be documented in the associated log file, <strong>audit.log</strong>, in the
<strong>/var/log/audit</strong> directory.</p>
<p>First, the audit search (ausearch) command can help filter for specific types of problems.
For example, the following command lists all SELinux events associated with the use of the
sudo command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ausearch</span> <span class="o">-</span><span class="n">m</span> <span class="n">avc</span> <span class="o">-</span><span class="n">c</span> <span class="n">sudo</span>
</pre></div>
</div>
<p>In contrast, the <strong>sealert -a /var/log/audit/audit.log</strong> command may provide more clarity.</p>
</div>
<div class="section" id="the-gui-selinux-administration-tool">
<h2>The GUI SELinux Administration Tool<a class="headerlink" href="#the-gui-selinux-administration-tool" title="Permalink to this headline">¶</a></h2>
<p>If you’ve taken the time to learn SELinux from the command line, this section should be just
a review. For many users, the easiest way to change SELinux settings is with the SELinux
Administration tool, which you can start with the <strong>system-config-selinux</strong> command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">policycoreutils</span><span class="o">-</span><span class="n">gui</span>
<span class="n">system</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">selinux</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../help/Help.html" class="btn btn-neutral float-right" title="Help" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="encryption.html" class="btn btn-neutral" title="encryption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Herwig Gans.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>